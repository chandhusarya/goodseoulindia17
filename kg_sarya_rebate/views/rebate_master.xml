<odoo>
  <data>

        <record id="product_rebate_list_view" model="ir.ui.view">
            <field name="name">product.rebatelist.form</field>
            <field name="model">product.rebatelist</field>
            <field name="arch" type="xml">
                <form string="Rebate Rule">
                    <sheet>
                        <div class="oe_title">
                            <h1><field name="name" placeholder="Rebate Rule Name"/></h1>
                        </div>  <group>
                                    <group>
                                <field name="rebate_type" widget="radio" options="{'horizontal': true}"/>
                                    </group>
                                    <group>
                                <field name="total_rebate_percent" sting="Total Rebate Percentage"
                                       invisible="rebate_type == 'progressive'"/>
                                </group>
                            </group>
                                <notebook>
                                    <page string="Rebate Rule">
                                    <field name="rebate_item_ids">
                                    <tree>
                                          <field name="name" string="Applicable On"
                                                 column_invisible="parent.rebate_type == 'fixed'"/>
                                          <field name="description" string="Applicable On"
                                                 column_invisible="parent.rebate_type == 'progressive'"/>
                                          <field name="percent_price"   string="Rebate Percentage"
                                                 column_invisible="parent.rebate_type == 'progressive'"/>
                                          <!-- <field name="max_quantity"/> -->
                                          <field name="price" string="Price"
                                                 column_invisible="parent.rebate_type == 'fixed'"/>
                                          <field name="date_start" column_invisible="parent.rebate_type == 'fixed'"/>
                                          <field name="date_end" column_invisible="parent.rebate_type == 'fixed'"/>
                                          <field name="base" column_invisible="True"/>
                                          <field name="price_discount" column_invisible="True"/>
                                          <field name="applied_on" column_invisible="True"/>
                                          <field name="compute_price" column_invisible="True"/>
                                    </tree>
                                </field>
                                    </page>
                                </notebook>
                        
                    </sheet>
                </form>
            </field>
        </record>


    <record id="customer_rebate_rule_action" model="ir.actions.act_window">
        <field name="name">Customer Rebate</field>
        <field name="res_model">product.rebatelist</field>
        <field name="view_mode">tree,form</field>
    </record>

        <menuitem name="Rebate Rule" id="customer_rebate_rule_menu" action="customer_rebate_rule_action" sequence="-1" parent="sale.menu_sale_config"/>

        <record id="product_rebate_item_form_view" model="ir.ui.view">
            <field name="name">product.rebate.item.form</field>
            <field name="model">product.rebate.item</field>
            <field name="arch" type="xml">
                <form string="Rebate Rule">
                    <sheet>
                        <group name="rebate_rule_computation"  string="Rebate Computation">
                            <group name="rebate_rule_method">
                                <field name="compute_price" string="Computation" widget="radio"/>
                            </group>
                            <div>
                                <div class="alert alert-info" role="alert" groups="uom.group_uom">
                                    The computed price is expressed in the default Unit of Measure of the product.
                                </div>
                            </div>
                        </group>
                        <group name="rebate_rule_base" >
                            <group>
                                <field name="fixed_price" widget="monetary"
                                       invisible="compute_price != 'fixed'"/>
                                <label for="percent_price" string="Rebate Percentage"
                                       invisible="compute_price != 'percentage'"/>
                                <div class="o_row" invisible="compute_price != 'percentage'">
                                    <field name="percent_price" class="oe_inline" invisible="compute_price != 'percentage'"/>%%
                                </div>
                                <field name="base"
                                       invisible="compute_price != 'formula'"/>
                                <field name="base_pricelist_id"
                                       invisible="compute_price != 'formula' or base != 'pricelist'"
                                       required="compute_price == 'formula' and base == 'pricelist'"
                                       readonly="base != 'pricelist'"/>
                                <label for="price_discount" string="Discount"
                                       invisible="compute_price != 'formula'"/>
                                <div class="o_row" invisible="compute_price != 'formula'">
                                    <field name="price_discount"/>
                                    <span>%%</span>
                                </div>
                                <field name="price_surcharge" widget="monetary" string="Extra Fee"
                                       invisible="compute_price != 'formula'"/>
                                <field name="price_round" string="Rounding Method" invisible="compute_price != 'formula'"/>
                                <label string="Margins" for="price_min_margin" invisible="compute_price != 'formula'"/>
                                <div class="o_row" invisible="compute_price != 'formula'">
                                    <field name="price_min_margin" string="Min. Margin" class="oe_inline" widget="monetary" nolabel="1"/>
                                    <i class="fa fa-long-arrow-right mx-2 oe_edit_only" aria-label="Arrow icon" title="Arrow"/>
                                    <field name="price_max_margin" string="Max. Margin" class="oe_inline" widget="monetary" nolabel="1"/>
                                </div>
                            </group>
                            <group>
                                <div class="alert alert-info" role="alert" style="white-space: pre;"
                                     invisible="compute_price != 'formula'">
                                    <field name="rule_tip"/>
                                </div>
                            </group>
                        </group>

                        <group string="Conditions">
                            <field name="rebate_type" column_invisible="True"/>
                            <group name="rebate_rule_target"
                                   invisible="rebate_type == 'fixed'">
                                <field name="applied_on" widget="radio"/>
                                <field name="categ_id" options="{'no_create':1}"
                                       invisible="applied_on != '2_product_category'"
                                       required="applied_on == '2_product_category' and rebate_type == 'progressive'"
                                      />
                                <field name="product_tmpl_id" options="{'no_create':1}"
                                       invisible="applied_on != '1_product'"
                                       required="applied_on == '1_product' and rebate_type == 'progressive'"
                                       />
                                <field name="product_id" options="{'no_create':1}"
                                       invisible="applied_on != '0_product_variant'"
                                       required="applied_on == '0_product_variant' and rebate_type == 'progressive'"
                                      />
                            </group>
                            <group name="rebate_rule_limits">
                                <field name="max_quantity"
                                       invisible="rebate_type == 'fixed'"/>
                                <field name="description"
                                       invisible="rebate_type == 'progressive'"/>
                                <label for="date_start" string="Validity"/>
                                <div class="o_row">
                                    <field name="date_start" widget="daterange" options='{"related_end_date": "date_end"}'/>
                                    <i class="fa fa-long-arrow-right mx-2 oe_edit_only" aria-label="Arrow icon" title="Arrow"/>
                                    <field name="date_end" widget="daterange" options='{"related_start_date": "date_start"}'/>
                                </div>
                            </group>
                            <group name="pricelist_rule_related" groups="base.group_no_one">
                                <field name="rebatelist_id" column_invisible="True"/>
                                <field name="currency_id" groups="base.group_multi_currency"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>


        <!-- rebate selection option in customer master -->
    <record id="res_customer_form_inherit" model="ir.ui.view">
        <field name="name">res.partner.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='category_id']" position='after'>
                <field name="rebate_id" string="Rebate"/>
            </xpath>
        </field>
    </record>

  </data>
</odoo>