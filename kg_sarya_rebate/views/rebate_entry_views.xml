<!--<?xml version="1.0" encoding="utf-8"?>-->
<odoo>

	<record id="rebate_entry_tree_view" model="ir.ui.view">
		<field name="name">rebate.entry.tree</field>
		<field name="model">rebate.entry</field>
		<field name="arch" type="xml">
			<tree string="Rebate Entries" create="0">
				<field name="date_start"/>
				<field name="date_end"/>
				<field name="partner_id"/>
				<field name="partner_parent_id" string="Parent" optional="hide"/>
				<field name="rebate_id"/>
				<field name="entry_type" optional="hide"/>
				<field name="fixed_rebate_percentage"/>
				<field name="total_rebate_fixed_amount"/>
				<field name="progressive_rebate_id"/>
				<field name="progressive_rebate_percentage" optional="hide"/>
				<field name="total_rebate_progressive_amount" sum="Total Progressive Rebate Amount"/>
				<field name="total_rebate_amount" sum="Total Rebate Amount"/>
				<field name="currency_id" column_invisible="True"/>
				<button name="action_show_fixed_rebates" type="object" class="btn text-info"
				        title="View fixed rebates breakdown" icon="fa-info"/>
				<button name="action_show_rebate_items" type="object" class="btn text-warning"
				        title="View related rebate items" icon="fa-list"/>
				<button name="action_show_move_ids" type="object" class="btn text-success"
				        title="View rebate journal items" icon="fa-list"
						invisible="move_ids == []"/>
				<field name="move_ids" column_invisible="True"/>
			</tree>
		</field>
	</record>

	<record id="rebate_entry_pivot_view" model="ir.ui.view">
		<field name="name">rebate.entry.pivot</field>
		<field name="model">rebate.entry</field>
		<field name="priority">60</field>
		<field name="arch" type="xml">
			<pivot string="Rebate Entries">
				<field name="date_start" interval="month" type="col"/>
				<field name="date_end" interval="month" type="col"/>
				<field name="partner_id" type="row"/>
				<field name="entry_type" type="row"/>
				<field name="total_rebate_progressive_amount" type="measure"/>
				<field name="total_rebate_fixed_amount" type="measure"/>
				<field name="total_rebate_amount" type="measure"/>
			</pivot>
		</field>
	</record>


	<record id="rebate_entry_form_view" model="ir.ui.view">
		<field name="name">rebate.entry.form</field>
		<field name="model">rebate.entry</field>
		<field name="arch" type="xml">
			<form string="Rebate" create="0">
				<sheet>
					<div class="oe_title">
						<label for="name" string="Reference"/>
						<h1><field name="name" placeholder="Reference"/></h1>
					</div>
					<group>
						<group>
							<field name="partner_id"/>
							<field name="rebate_id"/>
						</group>
						<group>
							<field name="date_start"/>
							<field name="date_end"/>
						</group>
					</group>
					<notebook>
						<page name="rebate" string="Rebate Information">
							<group>
								<group>
									<field name="rebate_id"/>
									<field name="progressive_rebate_id"/>
								</group>
								<group>
									<field name="total_rebate_fixed_amount"/>
									<field name="total_rebate_progressive_amount"/>
								</group>
							</group>
						</page>
						<page name="others" string="Other Information">
							<group>
								<group>
									<field name="company_id"/>
								</group>
								<group>
									<field name="currency_id"/>
								</group>
							</group>
						</page>
					</notebook>
				</sheet>
				<div class="oe_chatter">
					<field name="message_follower_ids"/>
					<field name="activity_ids"/>
					<field name="message_ids"/>
				</div>
			</form>
		</field>
	</record>

	<record id="rebate_entry_search" model="ir.ui.view">
		<field name="name">rebate.entry.search</field>
		<field name="model">rebate.entry</field>
		<field name="arch" type="xml">
			<search string="Rebate Entry">
				<field name="name" string="Rebate Entry" filter_domain="[('name', 'ilike', self)]"/>
				<field name="partner_id" string="Customer" filter_domain="[('partner_id', 'ilike', self)]"/>
				<field name="rebate_id" string="Rebate" filter_domain="[('rebate_id', 'ilike', self)]"/>
				<separator/>
				<group expand="1" string="Group By">
					<filter string="Invoice" name="groupby_rebate" context="{'group_by':'rebate_id'}"/>
					<filter string="Customer" name="groupby_customer" context="{'group_by':'partner_id'}"/>
					<filter string="Rebate" name="groupby_rebate" context="{'group_by':'rebate_id'}"/>
					<filter string="Start Date" name="groupby_date_start" context="{'group_by':'date_start'}"/>
					<filter string="End Date" name="groupby_date_end" context="{'group_by':'date_end'}"/>
				</group>
			</search>
		</field>
	</record>

	<!-- for view to show fixed rebate entry breakdowns -->
	<record id="fixed_entry_form_view" model="ir.ui.view">
		<field name="name">fixed.entry.form.view</field>
		<field name="model">rebate.entry</field>
		<field name="priority">1000</field>
		<field name="arch" type="xml">
			<form string="Fixed Rebate Breakdown">
				<group>
					<group>
						<field name="rebate_id" readonly="1"/>
					</group>
					<group>
						<field name="total_rebate_fixed_amount" readonly="1"/>
						<field name="fixed_rebate_percentage" readonly="1"/>
					</group>
				</group>
				<field name="fixed_rebate_lines" readonly="1">
					<tree>
						<field name="fixed_rebate_id"/>
						<field name="rebate_fixed_amount"/>
					</tree>
				</field>
				<footer>
					<button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="z"/>
				</footer>
			</form>
		</field>
	</record>

	<record id="action_rebate_fixed_entry" model="ir.actions.act_window">
		<field name="name">Fixed Rebate Breakdown</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">rebate.entry</field>
		<field name="view_id" ref="fixed_entry_form_view"/>
		<field name="target">new</field>
	</record>


	<record id="action_rebate_entry" model="ir.actions.act_window">
		<field name="name">Rebate Entries</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">rebate.entry</field>
		<field name="view_mode">pivot,graph,tree</field>
		<field name="search_view_id" ref="rebate_entry_search"/>
		<field name="view_id" eval="False"/> <!-- Force empty -->
		<field name="context">{'search_default_groupby_customer': 1, 'search_default_posted': 1}</field>
		<field name="help" type="html">
			<p class="o_view_nocontent_smiling_face">
				There are no rebate entries to show
			</p>
		</field>
	</record>


	<menuitem name="Rebate Entries" id="rebate_entry_menu_main" sequence="1" parent="kg_sarya_rebate.rebate_menu_main"/>
	<menuitem name="Rebate Entries" id="rebate_entry_menu" action="action_rebate_entry"
	          sequence="1" parent="kg_sarya_rebate.rebate_entry_menu_main"/>

</odoo>

